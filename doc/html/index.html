<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sol-verificaC19-sdk-cpp-linux: sol-verificaC19-cpp-linux</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sol-verificaC19-sdk-cpp-linux
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">sol-verificaC19-cpp-linux </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a></p>
<h2><a class="anchor" id="autotoc_md1"></a>
C++ library for decoding and validate the European Digital Green Certificate</h2>
<h3><a class="anchor" id="autotoc_md2"></a>
Summary</h3>
<p>The library allows to decode and validate any EU Digital Green Certificate, providing interfaces to easily implement specific providers for every country's backend.</p>
<h3><a class="anchor" id="autotoc_md3"></a>
Dependencies</h3>
<p>The following dependencies are used in the project by the verifier SDK:</p><ul>
<li><b><a href="https://github.com/madler/zlib">zlib</a>.</b> Zlib is a general-purpose, patent-free, lossless data compression library which is used by many different programs.</li>
<li><b><a href="https://github.com/jimsch/cn-cbor">cn-cbor</a>.</b> A constrained node implementation of CBOR in C.</li>
<li><b><a href="https://github.com/openssl/openssl">libcrypto</a>.</b> OpenSSL is a robust, commercial-grade, full-featured Open Source Toolkit for the Transport Layer Security (TLS) protocol formerly known as the Secure Sockets Layer (SSL) protocol.</li>
</ul>
<p>The following dependencies are used in the project by the examples:</p><ul>
<li><b><a href="https://github.com/curl/curl">libcurl</a>.</b> Library for transferring data specified with URL syntax.</li>
<li><b><a href="https://github.com/open-source-parsers/jsoncpp">jsoncpp</a>.</b> JSON is a lightweight data-interchange format. It can represent numbers, strings, ordered sequences of values, and collections of name/value pairs.</li>
</ul>
<h3><a class="anchor" id="autotoc_md4"></a>
Build</h3>
<p>Once cloned, to build on your system you can use this command:</p>
<div class="fragment"><div class="line">cmake .</div>
<div class="line">make</div>
<div class="line">make install # as root or sudoer</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md5"></a>
Tested architectures</h3>
<p>This SDK has been tested in these architectures:</p><ul>
<li>x86-64</li>
<li>ARM v4T</li>
<li>ARM v7</li>
</ul>
<h3><a class="anchor" id="autotoc_md6"></a>
Usage</h3>
<p>The main entry point of the library is the <code>DGCVerifier</code> class.</p>
<p>This class needs a implementation of IKeysStorage and IRulesStorage interfaces to access to storage.</p>
<p>Optionally you can use a implementation of ILogger interface to log operations.</p>
<p>You can simply instantiate and configure it:</p>
<div class="fragment"><div class="line">#include &lt;verificaC19-sdk/DGCVerifier.hpp&gt;</div>
<div class="line"> </div>
<div class="line">LoggerStdout logger(DEBUG);</div>
<div class="line">KeysStorageMemory keysStorage;</div>
<div class="line">RulesStorageMemory rulesStorage;</div>
<div class="line"> </div>
<div class="line">DGCVerifier verifier(&amp;keysStorage, &amp;rulesStorage, &amp;logger);</div>
</div><!-- fragment --><p>Once instantiated and configured with storage services, you can simply use it calling the following methods:</p>
<div class="fragment"><div class="line">...</div>
<div class="line">if (!verifier.verifyMinSdkVersion()) {</div>
<div class="line">  logger.error(&quot;Minimum SDK version does not match&quot;);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">std::string qrCode = &quot;Raw qr code data starting with HC1:&quot;;</div>
<div class="line"> </div>
<div class="line">// Decode and validate the qr code data.</div>
<div class="line">// The result will contain all the details of the validated object</div>
<div class="line">CertificateSimple result = verifier.verify(qrCode);</div>
<div class="line"> </div>
<div class="line">enum CertificateStatus status = result.certificateStatus;</div>
<div class="line">...</div>
</div><!-- fragment --><p>The rules and keys updater process is managed by th <code>DGCRulesKeysUpdater</code> class.</p>
<p>This class needs a implementation of IKeysStorage and IRulesStorage interfaces to access to storage and IKeysProvider and IRulesProvider interfaces to access to providers.</p>
<p>Optionally you can use a implementation of ILogger interface to log operations.</p>
<p>You can simply instantiate and configure it:</p>
<div class="fragment"><div class="line">#include &lt;verificaC19-sdk/DGCRulesKeysUpdater.hpp&gt;</div>
<div class="line"> </div>
<div class="line">LoggerStdout logger(DEBUG);</div>
<div class="line">KeysStorageMemory keysStorage;</div>
<div class="line">RulesStorageMemory rulesStorage;</div>
<div class="line">KeysProviderItaly(&amp;logger);</div>
<div class="line">RulesProviderItaly(&amp;logger);</div>
<div class="line"> </div>
<div class="line">DGCRulesKeysUpdater rulesKeyUpdater(86400, &amp;rulesProvider, &amp;rulesStorage,</div>
<div class="line">        &amp;keysProvider, &amp;keysStorage, &amp;logger);</div>
</div><!-- fragment --><p>so the complete example with rules and keys update and DGC verify is:</p>
<div class="fragment"><div class="line">#include &lt;verificaC19-sdk/DGCVerifier.hpp&gt;</div>
<div class="line">#include &lt;verificaC19-sdk/DGCRulesKeysUpdater.hpp&gt;</div>
<div class="line"> </div>
<div class="line">// Initialization (at startup)</div>
<div class="line"> </div>
<div class="line">LoggerStdout logger(DEBUG);</div>
<div class="line">KeysStorageMemory keysStorage;</div>
<div class="line">RulesStorageMemory rulesStorage;</div>
<div class="line">KeysProviderItaly keysProvider(&amp;logger);</div>
<div class="line">RulesProviderItaly rulesProvider(&amp;logger);</div>
<div class="line"> </div>
<div class="line">// This automatically updates rules and keys every 86400 seconds</div>
<div class="line">DGCRulesKeysUpdater rulesKeyUpdater(86400, &amp;rulesProvider, &amp;rulesStorage,</div>
<div class="line">        &amp;keysProvider, &amp;keysStorage, &amp;logger);</div>
<div class="line"> </div>
<div class="line">DGCVerifier verifier(&amp;keysStorage, &amp;rulesStorage, &amp;logger);</div>
<div class="line"> </div>
<div class="line">// At startup wait to have a valid set of rules and keys, if this is</div>
<div class="line">// first application launch the storage cuold be empty</div>
<div class="line">if (!rulesKeyUpdater.isUpdated()) {</div>
<div class="line">    // Signal to user that rules and keys is updating</div>
<div class="line">    while (!rulesKeyUpdater.isUpdated()) {</div>
<div class="line">        usleep(10000);</div>
<div class="line">    }</div>
<div class="line">    // Signal to user that rules and keys was updated</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">// Usage (for every readed Digital Certificate)</div>
<div class="line"> </div>
<div class="line">if (!verifier.verifyMinSdkVersion()) {</div>
<div class="line">  logger.error(&quot;Minimum SDK version does not match&quot;);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">std::string qrCode = &quot;Raw qr code data starting with HC1:&quot;;</div>
<div class="line"> </div>
<div class="line">// Decode and validate the qr code data.</div>
<div class="line">// The result will contain all the details of the validated object</div>
<div class="line">CertificateSimple result = verifier.verify(qrCode);</div>
<div class="line"> </div>
<div class="line">enum CertificateStatus status = result.certificateStatus;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md7"></a>
Rules and Keys storage</h3>
<p>Rules and Keys storage are mandatory services and must be implemented using IRulesStorage and IKeysStorage interfaces.</p>
<p>SDK provide example implementations to store Rules and Keys in memory, (RulesStorageMemory and KeysStorageMemory) but you can implement storage in File or in Database.</p>
<p>Interfaces declare methods to:</p><ul>
<li>store Rule or Key without transaction</li>
<li>store Rules or Keys in transaction, to use "old" Rules or Keys until update is done</li>
<li>get info about Rules or Keys update in progress</li>
<li>get info about Rules or Keys last update time</li>
<li>get info about last Key token stored</li>
</ul>
<h3><a class="anchor" id="autotoc_md8"></a>
Rules and Keys provider</h3>
<p>Rules and Keys update provider are an optional services used to update Keys and Rules and can be implemented using IRulesProvider, IKeysProbider or IRulesKeysProvider interfaces.</p>
<p>SDK provide example implementations to update Rules and Keys from Italian provider, (RulesProviderItaly and KeysProviderItaly) but you can implement provider to get Rules or Keys from other states or by your custom provider.</p>
<p>Interfaces declare methods to refresh Rules or Keys or All (IRulesKeysProvider).</p>
<p>Interface methods request instance of Rules or Keys storage interface as described above.</p>
<h3><a class="anchor" id="autotoc_md9"></a>
Logger</h3>
<p>SDK contemplate use of logger with interface ILogger, but you can easily set a NULL pointer to this to not have log or implement you logger.</p>
<p>We provide example implementation of standard output logger.</p>
<h3><a class="anchor" id="autotoc_md10"></a>
Disclaimer</h3>
<p>This library is <b>not</b> an official implementation, therefore its use may be subject to restrictions by some countries regulations. The author assumes no responsibility for any unauthorized use of the library and no warranties about the correctness of the implementation, as better stated in the License.</p>
<h3><a class="anchor" id="autotoc_md11"></a>
Licensing</h3>
<p>Licensed under the <b>Apache License, Version 2.0</b> (the "License"); you may not use this file except in compliance with the License.</p>
<p>You may obtain a copy of the License at <a href="https://www.apache.org/licenses/LICENSE-2.0">https://www.apache.org/licenses/LICENSE-2.0</a>.</p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the <a href="./LICENSE">LICENSE</a> for the specific language governing permissions and limitations under the License. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
